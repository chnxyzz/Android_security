# Vulnerabilities and threats in mobile applications

2019

非安全存储是最普遍的问题，76%手机应用的密码，金融信息，个人数据都存在危险。风险不一定是客户端或服务器端的任何特定漏洞造成的。在许多情况下，它们是移动应用程序各个部分中几个看似很小的缺陷的产物。任何网络攻击都依赖于用户注意力不集中。升级的权限或侧载软件可以为破坏性攻击铺平道路。

移动应用程序具有客户端-服务器架构。客户端在操作系统上运行，常见的是Android或iOS。服务器，由开发人员托管。通常，此角色由负责在网站上生成和处理内容的相同软件执行。换句话说，服务器端组件通常是通过特殊应用程序编程接口（API）通过Internet与移动客户端交互的Web应用程序。所以实际上我们可以将服务器视为更重要的组件。它是存储和处理信息的地方。服务器还负责在设备之间同步用户数据。现代移动操作系统具有各种安全机制。默认情况下，已安装的应用程序只能访问其自己的沙箱目录中的文件，并且用户权限不允许编辑系统文件。然而，开发人员在为移动应用程序设计和编写代码时所犯的错误会导致保护方面的漏洞，并且可能被攻击者滥用。客户端和服务器中的漏洞，以及它们之间的数据传输。

Client-side vulnerabilities
60%的的安全在客户端、89%的漏洞可以非接触利用、56%的漏洞可以不需要root被利用。
非安全进程对话（IPC）允许攻击者远程访问易受攻击的移动应用。（Broadcast）
自iOS 8以来，Apple已经允许使用第三方键盘（Android已经并且继续支持它们）。值得注意的是，iOS对键盘使用的限制比Android更严格。但如果用户允许网络交互，Apple无法控制键盘开发人员使用击键数据做什么。
Android移动应用程序中三分之一的漏洞源于配置缺陷。例如，我们的专家在分析AndroidManifest.xml时经常发现android：allowBackup属性设置为“true”。这允许在设备连接到计算机时创建应用程序数据的备份副本。即使在非root设备上，攻击者也可以使用此漏洞获取应用程序数据。
移动设备允许查看最近使用的应用程序并在它们之间快速切换。应用程序移至后台后，操作系统会为此目的捕获应用程序当前状态的快照。只有在有根设备上才能直接访问这些快照。确保快照不包含敏感数据非常重要。例如，如果所有者只是使用移动银行应用程序，则快照可能包含卡号。如果设备受到感染，这些快照可能会被盗。

Server-side vulnerabilities
每季度发现150到200万个新的恶意软件变种。截至2018年底，共有超过3000万个恶意软件变种。移动设备恶意软件数量和种类的不断增长推动了客户端组件攻击的普及。
早在2012年，弱服务器端控制在OWASP Mobile Top 10评级中排名第二。 2016年，服务器端漏洞甚至没有列出十大最常见的威胁。但是，与服务器缺陷相关的风险仍然存在，并且由于服务器漏洞导致的主要数据泄漏仍在继续发生。我们的研究表明，服务器端与客户端一样脆弱：43％的服务器端组件具有“低”的安全级别或
“非常贫穷”，33％的人包含严重的漏洞。
服务器端组件包含应用程序代码和应用程​​序保护机制中的漏洞。后者包括实施双因素身份验证的缺陷。攻击者可以拦截SMS消息并冒充合法用户，例如，清理用户的银行帐户。
平均服务器端组件包含五个代码漏洞和一个配置漏洞。配置缺陷包括错误消息中的敏感信息泄露，HTTP标头中的指纹识别以及TRACE可用性。
当对TRACE请求的支持与跨站点脚本（XSS）漏洞相结合时，攻击者可以窃取cookie并获取对该应用程序的访问权限。由于移动应用程序的服务器端组件倾向于与网站共享相同的代码，因此跨站点脚本允许攻击Web应用程序的用户。
信息泄漏是服务器端组件的另一个普遍问题，可能会产生严重后果。
我们研究的几乎所有应用程序都有被黑客访问的风险。在客户端漏洞部分，我们指出移动应用程序中最常见的问题是不安全的数据存储。信息落入黑客手里，恶意感染。TheBestVPN的专家研究了来自Google Play的81个VPN应用程序，发现他们中的许多人都要求有问题的权限。
Mobile application threats
不安全的数据存储。
有时，移动应用程序可能会被攻击而没有任何恶意软件或黑客实用程序。例如，应用程序可能对输入PIN码的尝试次数没有限制，或者仅在客户端设置此限制，并且在应用程序重新启动时重置计数。在这两种情况下，攻击者都可以进行无限次的密码输入尝试。
服务器端漏洞可以启用对用户的攻击。在86％的服务器端组件中发现了跨站点脚本，这是最常见的Web漏洞。攻击者可以借助恶意脚本使用它来窃取受害者凭据，例如cookie。如果移动应用程序使用支持HTML和JavaScript的组件，则此漏洞可能会威胁到它们。例如，WebView是一个系统组件，允许Android应用程序直接在应用程序中显示Web内容。* iOS有类似的组件，称为UIWebView和WKWebView。

注入邮件头或HTML标记对于网络钓鱼攻击很有用。通过注入邮件头，攻击者可以向拥有移动应用程序的公司的任何员工发送电子邮件给应用程序用户。
通常，威胁是由客户端和服务器中的故障组合引起的。例如，想象一下，当用户退出应用程序时，会话ID不会在客户端删除，而是在每次新请求时发送到服务器，包括在重新身份验证期间。反过来，服务器不会检查会话超时，并且在身份验证之后它会重新激活旧的会话ID。在这种情况下，任何知道会话ID的攻击者都可以冒充用户。
客户端和服务器之间的通信也很脆弱。如果客户端使用不安全的HTTP与服务器通信，则攻击者可以拦截敏感数据。例如，在移动银行的情况下，所有支付信息都受到危害。要防止拦截，请使用安全HTTPS协议。这使得连接安全，因为所有数据都是加密的。该设备存储证书。这些特殊文件告诉客户端应该将数据发送到的服务器的名称。
但即使使用HTTPS，客户端 - 服务器通信也不总是安全的。在设备上，证书保存在所有应用程序使用的存储中。恶意软件可以在受害者的智能手机上安装攻击者的根证书 - 在这种情况下，使用伪根证书验证的所有证书都将被视为可信任。因此，如果受害者连接到攻击者控制的网络设备（例如Wi-Fi路由器），攻击者就可以执行中间人（MITM）攻击。通过坐在连接中间并监听流量，攻击者会泄露所有传输的数据。
除了客户端 - 服务器通信之外，应用程序还可以包含用于通过不安全的HTTP从外部发送数据的链接。不安全的数据传输在Android上更为常见。从版本9开始，iOS提供了App Transport Security，默认情况下禁止不安全的数据传输。但是，开发人员可以明确地以地址的形式列出异常，但仍允许不安全的通信。这在应用程序调试期间可能很有用，但不安全的链接通常最终会出现在公众使用的最终版本中。

Risks for users
我们的研究表明，所有移动应用都很脆弱。在利用漏洞的情况下，可能需要物理访问设备，但通常可以通过Internet远程完成。每个经过测试的移动应用程序都包含至少一个可以使用恶意软件远程利用的漏洞。
有时，黑客需要完全访问文件系统：iOS上的越狱或Android上的root权限。但即使这并不总是一个挑战。在尝试绕过各种限制，侧载软件或自定义用户界面时，许多移动设备所有者会故意升级其在操作系统中的权限。根据研究人员的数据，8％的iOS用户使用越狱设备，27％的Android设备使用root权限运行。具有此类权限的设备风险更大，因为恶意软件可能会滥用这些权限。例如，KeyRaider恶意软件通过应用程序分发平台传播，用于越狱设备，并窃取来自225,000名iOS用户的凭据，证书和加密密钥。
由于恶意软件问题的严重性，谷歌和苹果正在采取积极措施打击网络犯罪分子。为了防止黑客入侵，Google提供Google Play Protect扫描Android设备和Google Play本身的应用程序。为防止通过Apple App Store分发恶意软件，Apple会在开发人员应用程序可供下载之前对其进行手动分析。
此分析有助于减少恶意应用程序的数量，但无法捕获所有恶意应用程序。恶意软件甚至可以来自官方应用程序商店。黑客设法使用XcodeGhost将39个恶意程序上传到App Store，XcodeGhost是用于为Apple设备创建应用程序的合法Xcode开发环境的虚假版本。另一个例子是Anubis，一种成功逃避Google Play和Android安全系统安全检查的银行木马。
官方应用程序商店只是恶意软件感染设备的一种方式。即使是全新的智能手机也可能包含恶意代码。例如，开发人员攻击导致间谍软件预先安装在阿尔卡特智能手机上。用户设备甚至在第一次启动之前就已经受到损害。另一个例子是TimpDoor后门，黑客通过使用SMS向受害者发送链接来分发。
为了防止攻击，iOS禁止从App Store以外的其他来源下载软件。但是有办法解决这个限制。这些包括使用用户自己的证书和移动设备管理（MDM）。为此，用户必须手动确认应用程序开发人员的证书是否可信，并允许从不受信任的来源下载和安装应用程序。在网络钓鱼攻击中，黑客
可能成功说服用户执行这些步骤。
Apple禁止App Store应用程序使用私有API。这些API包含可用于下载其他应用程序和执行其他操作的方法。特洛伊木马可以使用私有API在受害者的设备上安装其他非App Store软件，从而绕过Apple的任何安全检查。然而，从YiSpecter等恶意软件的分发来看，Apple的检查本身并不完美。 YiSpecter攻击者使用的技术非常简单。用户打开受感染的链接，确认从App Store外部安装软件，并且设备被感染。一旦进入受害者的设备，YiSpecter使用私有API并自动下载其他程序来窃取个人数据。
在Apple设备上安装恶意软件的另一种方法是将应用程序文件（.ipa）下载到受害者的计算机，并在受害者的Apple ID（iCloud帐户）和应用程序安装程序（例如Cydia Impactor）的帮助下安装它们。 USB连接。此恶意软件可以作为App Store软件的免费（“破解”）版本在非官方商店中分发。这就是设备被WireLurker感染的方式。

谷歌关于从其他来源下载应用程序的政策不那么严格。在OS设置期间，用户决定是否允许从非官方来源下载软件。据统计，每五分之一的Android设备允许从第三方来源安装应用程序。此外，7％的Apple设备和3％的Android设备至少有一个应用程序是从非官方商店安装的。请记住，管理员权限已经删除了软件下载的任何iOS或Android限制。
安全取决于用户。设备所有者必须负责保护他们存储在移动应用程序中的数据。但是，如果开发人员在应用程序中留下漏洞，用户预防措施仍然不足。不幸的是，并非所有移动软件开发人员都能适应这种情况。
Conclusions
黑客喜欢瞄准移动设备，因为这些设备有很多个人数据和支付卡的信息。我们的结果表明，移动应用程序的开发人员经常忽视安全性，主要问题是不安全的数据存储。存储在明文中的用户信息，屏幕截图中的未屏蔽数据以及源代码中的密钥和密码只是为网络攻击者提供机会的一些缺陷。用户本身可能无意中通过扩展智能手机功能，禁用保护，打开SMS消息中的可疑链接以及从非正式来源下载软件来帮助改进其设备。保护用户数据需要应用程序开发人员和设备所有者采取负责任的态度。
我们也不能低估服务器漏洞的作用。移动应用服务器的保护并不比客户端好。在2018年，每个经过测试的服务器端组件都至少包含一个漏洞，可以对用户进行各种攻击，包括模仿开发人员的网络钓鱼电子邮件，使开发人员的声誉处于危险之中。为防止利用服务器漏洞，我们建议使用Web应用程序防火墙（WAF）。
除客户端和服务器漏洞外，风险还包括客户端 - 服务器通信。通过不安全协议发送的数据可能会完全受到损害。但即使是安全的连接也并非总是安全的。开发人员仍然尚未深入理解安全性的重要性。
保护机制是移动应用中的弱点。大多数发现的漏洞是在设计阶段引入的，是由于未能“思考”与安全相关的问题造成的。我们建议采用有条理的方法来设计和跟踪移动应用程序的安全性，从软件生命周期的第1天开始定期对其进行测试。最有效的方法是白盒测试，安全分析师可以完全访问源代码。
https://www.ptsecurity.com/upload/corporate/ww-en/analytics/Mobile-Application-Vulnerabilities-and-Threats-2019-eng.pdf
